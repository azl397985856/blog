<aside class='l_side'>
  <% if (theme.sidebar && theme.sidebar.length){ %>
    <%
    let supportWidgets = ['author', 'category', 'list', 'music', 'tagcloud', 'toc', 'plain', 'related_posts', 'grid'];
    %>
    <% if (page.sidebar) { %>
      <% page.sidebar.forEach(function(name){ %>
        <% theme.sidebar.forEach(function(item){ %>
          <% let widget_name = item.widget ? item.widget : 'plain'; %>
          <% if (item.enable != false && widget_name == name){ %>
            <% if (supportWidgets.indexOf(widget_name) > -1){ %>
              <%- partial('../_widget/' + item.widget, {item: item}) %>
            <% } %>
          <% } %>
        <% }) %>
      <% }) %>
    <% } else { %>
      <%
      var names = [];
      if(is_home() || is_category() || is_archive() || is_tag() || page.layout == 'list') {
        var isPostList = true;
      } else {
        var isPostList = false;
      }
      if (isPostList) {
        names = theme.layout.posts.sidebar;
      } else {
        names = theme.layout.article.sidebar;
      }
      %>
      <% names.forEach(function(name){ %>
        <% theme.sidebar.forEach(function(item){ %>
          <% let widget_name = item.widget ? item.widget : 'plain'; %>
          <% if (item.enable != false && widget_name == name){ %>
            <% if (supportWidgets.indexOf(widget_name) > -1){ %>
              <%- partial('../_widget/' + item.widget, {item: item}) %>
            <% } %>
          <% } %>
        <% }) %>
      <% }) %>
    <% } %>

  <% } %>
</aside>

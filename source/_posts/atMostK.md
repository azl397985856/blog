---
title: ã€è¥¿æ³•å¸¦ä½ å­¦ç®—æ³•ã€‘ä¸€æ¬¡æå®šå‰ç¼€å’Œ
tags: [ç»éªŒåˆ†äº«, LeetCode, å›°éš¾, ä¸­ç­‰, å­æ•°ç»„, æ»‘åŠ¨çª—å£, k é—®é¢˜, å‰ç¼€å’Œ]
date: 2020-09-27
categories:
  - [LeetCode]
  - [ç®—æ³•]
---

æœ¬æ–‡æ˜¯å‰ç¼€å’Œä¸“é¢˜ç¬¬ä¸€ç¯‡ã€‚ç³»åˆ—ç›®å½•å¦‚ä¸‹:

- ä¸€ç»´å‰ç¼€å’Œï¼ˆæœ¬æ–‡ï¼‰
- [äºŒç»´å‰ç¼€å’Œ](https://lucifer.ren/blog/2021/02/20/2d-pre/)

æˆ‘èŠ±äº†å‡ å¤©æ—¶é—´ï¼Œä»åŠ›æ‰£ä¸­ç²¾é€‰äº†äº”é“ç›¸åŒæ€æƒ³çš„é¢˜ç›®ï¼Œæ¥å¸®åŠ©å¤§å®¶è§£å¥—ï¼Œå¦‚æœè§‰å¾—æ–‡ç« å¯¹ä½ æœ‰ç”¨ï¼Œè®°å¾—ç‚¹èµåˆ†äº«ï¼Œè®©æˆ‘çœ‹åˆ°ä½ çš„è®¤å¯ï¼Œæœ‰åŠ¨åŠ›ç»§ç»­åšä¸‹å»ã€‚

- [467. ç¯ç»•å­—ç¬¦ä¸²ä¸­å”¯ä¸€çš„å­å­—ç¬¦ä¸²](https://leetcode-cn.com/problems/unique-substrings-in-wraparound-string/ "467. ç¯ç»•å­—ç¬¦ä¸²ä¸­å”¯ä¸€çš„å­å­—ç¬¦ä¸²")(ä¸­ç­‰)
- [795. åŒºé—´å­æ•°ç»„ä¸ªæ•°](https://leetcode-cn.com/problems/number-of-subarrays-with-bounded-maximum/ "795. åŒºé—´å­æ•°ç»„ä¸ªæ•°")(ä¸­ç­‰)
- [904. æ°´æœæˆç¯®](https://leetcode-cn.com/problems/fruit-into-baskets/ "904. æ°´æœæˆç¯®")(ä¸­ç­‰)
- [992. K ä¸ªä¸åŒæ•´æ•°çš„å­æ•°ç»„](https://leetcode-cn.com/problems/subarrays-with-k-different-integers/ "992. K ä¸ªä¸åŒæ•´æ•°çš„å­æ•°ç»„")ï¼ˆå›°éš¾ï¼‰
- [1109. èˆªç­é¢„è®¢ç»Ÿè®¡](https://leetcode-cn.com/problems/corporate-flight-bookings/ "1109. èˆªç­é¢„è®¢ç»Ÿè®¡")(ä¸­ç­‰)

å‰å››é“é¢˜éƒ½æ˜¯æ»‘åŠ¨çª—å£çš„å­ç±»å‹ï¼Œæˆ‘ä»¬çŸ¥é“æ»‘åŠ¨çª—å£é€‚åˆåœ¨é¢˜ç›®è¦æ±‚è¿ç»­çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œ è€Œ[å‰ç¼€å’Œ](https://oi-wiki.org/basic/prefix-sum/ "å‰ç¼€å’Œ")ä¹Ÿæ˜¯å¦‚æ­¤ã€‚äºŒè€…åœ¨è¿ç»­é—®é¢˜ä¸­ï¼Œå¯¹äº**ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦**æœ‰ç€å¾ˆé‡è¦çš„æ„ä¹‰ã€‚ å› æ­¤å¦‚æœä¸€é“é¢˜ä½ å¯ä»¥ç”¨æš´åŠ›è§£å†³å‡ºæ¥ï¼Œè€Œä¸”é¢˜ç›®æ°å¥½æœ‰è¿ç»­çš„é™åˆ¶ï¼Œ é‚£ä¹ˆæ»‘åŠ¨çª—å£å’Œå‰ç¼€å’Œç­‰æŠ€å·§å°±åº”è¯¥è¢«æƒ³åˆ°ã€‚

é™¤äº†è¿™å‡ é“é¢˜ï¼Œ è¿˜æœ‰å¾ˆå¤šé¢˜ç›®éƒ½æ˜¯ç±»ä¼¼çš„å¥—è·¯ï¼Œ å¤§å®¶å¯ä»¥åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­è¿›è¡Œä½“ä¼šã€‚ä»Šå¤©æˆ‘ä»¬å°±æ¥ä¸€èµ·å­¦ä¹ ä¸€ä¸‹ã€‚

<!-- more -->

## å‰èœ

æˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„é—®é¢˜å…¥æ‰‹ï¼Œè¯†åˆ«ä¸€ä¸‹è¿™ç§é¢˜çš„åŸºæœ¬å½¢å¼å’Œå¥—è·¯ï¼Œä¸ºä¹‹åçš„å››é“é¢˜æ‰“åŸºç¡€ã€‚å½“ä½ äº†è§£äº†è¿™ä¸ªå¥—è·¯ä¹‹åï¼Œ ä¹‹ååšè¿™ç§é¢˜å°±å¯ä»¥ç›´æ¥å¥—ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯è¿™å››é“é¢˜çš„å‰ç½®çŸ¥è¯†éƒ½æ˜¯ `æ»‘åŠ¨çª—å£`ï¼Œ ä¸ç†Ÿæ‚‰çš„åŒå­¦å¯ä»¥å…ˆçœ‹ä¸‹æˆ‘ä¹‹å‰å†™çš„ [æ»‘åŠ¨çª—å£ä¸“é¢˜ï¼ˆæ€è·¯ + æ¨¡æ¿ï¼‰](https://github.com/azl397985856/leetcode/blob/master/thinkings/slide-window.md "æ»‘åŠ¨çª—å£ä¸“é¢˜ï¼ˆæ€è·¯ + æ¨¡æ¿ï¼‰")

### æ¯é¢˜ 0

æœ‰ N ä¸ªçš„æ­£æ•´æ•°æ”¾åˆ°æ•°ç»„ A é‡Œï¼Œç°åœ¨è¦æ±‚ä¸€ä¸ªæ–°çš„æ•°ç»„ Bï¼Œæ–°æ•°ç»„çš„ç¬¬ i ä¸ªæ•° B[i]æ˜¯åŸæ•°ç»„ A ç¬¬ 0 åˆ°ç¬¬ i ä¸ªæ•°çš„å’Œã€‚

è¿™é“é¢˜å¯ä»¥ä½¿ç”¨å‰ç¼€å’Œæ¥è§£å†³ã€‚ å‰ç¼€å’Œæ˜¯ä¸€ç§é‡è¦çš„é¢„å¤„ç†ï¼Œèƒ½å¤§å¤§é™ä½æŸ¥è¯¢çš„æ—¶é—´å¤æ‚åº¦ã€‚æˆ‘ä»¬å¯ä»¥ç®€å•ç†è§£å‰ç¼€å’Œä¸ºâ€œæ•°åˆ—çš„å‰ n é¡¹çš„å’Œâ€ã€‚

è¿™ä¸ªæ¦‚å¿µå…¶å®å¾ˆå®¹æ˜“ç†è§£ï¼Œå³ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œç¬¬ n ä½å­˜å‚¨çš„æ˜¯æ•°ç»„å‰ n ä¸ªæ•°å­—çš„å’Œã€‚

ä¾‹å¦‚ï¼Œå¯¹ [1,2,3,4,5,6] æ¥è¯´ï¼Œå…¶å‰ç¼€å’Œå°±æ˜¯ pre=[1,3,6,10,15,21]ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¬å¼ pre[ğ‘–]=pre[ğ‘–âˆ’1]+nums[ğ‘–]å¾—åˆ°æ¯ä¸€ä½å‰ç¼€å’Œçš„å€¼ï¼Œä»è€Œé€šè¿‡å‰ç¼€å’Œè¿›è¡Œç›¸åº”çš„è®¡ç®—å’Œè§£é¢˜ã€‚å¦‚æœæƒ³å¾—åˆ°æŸä¸€ä¸ªè¿ç»­åŒºé—´[l,r]çš„å’Œåˆ™å¯ä»¥é€šè¿‡ pre[r] - pre[l-1] å–å¾—ï¼Œä¸è¿‡è¿™é‡Œ l éœ€è¦ > 0ã€‚æˆ‘ä»¬å¯ä»¥åŠ ä¸€ä¸ªç‰¹æ®Šåˆ¤æ–­ï¼Œå¦‚æœ l = 0ï¼ŒåŒºé—´ [l,r] çš„å’Œå°±æ˜¯ pre[r]ã€‚

> æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å‰ç¼€å’Œé¦–é¡¹å‰é¢æ·»åŠ ä¸€ä¸ª 0 çœå»è¿™ç§ç‰¹æ®Šåˆ¤æ–­ï¼Œç®—æ˜¯ä¸€ä¸ªå°æŠ€å·§å§ã€‚

å…¶å®å‰ç¼€å’Œçš„æ¦‚å¿µå¾ˆç®€å•ï¼Œä½†å›°éš¾çš„æ˜¯å¦‚ä½•åœ¨é¢˜ç›®ä¸­ä½¿ç”¨å‰ç¼€å’Œä»¥åŠå¦‚ä½•ä½¿ç”¨å‰ç¼€å’Œçš„å…³ç³»æ¥è¿›è¡Œè§£é¢˜ã€‚

### æ¯é¢˜ 1

å¦‚æœè®©ä½ æ±‚ä¸€ä¸ªæ•°ç»„çš„è¿ç»­å­æ•°ç»„æ€»ä¸ªæ•°ï¼Œä½ ä¼šå¦‚ä½•æ±‚ï¼Ÿå…¶ä¸­è¿ç»­æŒ‡çš„æ˜¯æ•°ç»„çš„ç´¢å¼•è¿ç»­ã€‚ æ¯”å¦‚ [1,3,4]ï¼Œå…¶è¿ç»­å­æ•°ç»„æœ‰ï¼š`[1], [3], [4], [1,3], [3,4] , [1,3,4]`ï¼Œä½ éœ€è¦è¿”å› 6ã€‚

ä¸€ç§æ€è·¯æ˜¯æ€»çš„è¿ç»­å­æ•°ç»„ä¸ªæ•°ç­‰äºï¼š**ä»¥ç´¢å¼•ä¸º 0 ç»“å°¾çš„å­æ•°ç»„ä¸ªæ•° + ä»¥ç´¢å¼•ä¸º 1 ç»“å°¾çš„å­æ•°ç»„ä¸ªæ•° + ... + ä»¥ç´¢å¼•ä¸º n - 1 ç»“å°¾çš„å­æ•°ç»„ä¸ªæ•°**ï¼Œè¿™æ— ç–‘æ˜¯å®Œå¤‡çš„ã€‚

![](https://tva1.sinaimg.cn/large/007S8ZIlly1gj6m27kgbsj306u06gt8u.jpg)

åŒæ—¶**åˆ©ç”¨æ¯é¢˜ 0 çš„å‰ç¼€å’Œæ€è·¯ï¼Œ è¾¹éå†è¾¹æ±‚å’Œã€‚**

å‚è€ƒä»£ç (JS)ï¼š

```js
function countSubArray(nums) {
  let ans = 0;
  let pre = 0;
  for (_ in nums) {
    pre += 1;
    ans += pre;
  }
  return ans;
}
```

**å¤æ‚åº¦åˆ†æ**

- æ—¶é—´å¤æ‚åº¦ï¼š$O(N)$ï¼Œå…¶ä¸­ N ä¸ºæ•°ç»„é•¿åº¦ã€‚
- ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$

è€Œç”±äºä»¥ç´¢å¼•ä¸º i ç»“å°¾çš„å­æ•°ç»„ä¸ªæ•°å°±æ˜¯ i + 1ï¼Œå› æ­¤è¿™é“é¢˜å¯ä»¥ç›´æ¥ç”¨ç­‰å·®æ•°åˆ—æ±‚å’Œå…¬å¼ `(1 + n) * n / 2`ï¼Œå…¶ä¸­ n æ•°ç»„é•¿åº¦ã€‚

### æ¯é¢˜ 2

æˆ‘ç»§ç»­ä¿®æ”¹ä¸‹é¢˜ç›®ï¼Œ å¦‚æœè®©ä½ æ±‚ä¸€ä¸ªæ•°ç»„ç›¸é‚»å·®ä¸º 1 è¿ç»­å­æ•°ç»„çš„æ€»ä¸ªæ•°å‘¢ï¼Ÿï¼ˆå¦‚æœåªæœ‰ä¸€ä¸ªæ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿè®¤ä¸ºå…¶å®ä¸€ä¸ªç›¸é‚»å·®ä¸º 1 è¿ç»­å­æ•°ç»„ï¼‰å…¶å®å°±æ˜¯**ç´¢å¼•å·® 1 çš„åŒæ—¶ï¼Œå€¼ä¹Ÿå·® 1ã€‚**

å’Œä¸Šé¢æ€è·¯ç±»ä¼¼ï¼Œæ— éå°±æ˜¯å¢åŠ å·®å€¼çš„åˆ¤æ–­ã€‚

å‚è€ƒä»£ç (JS)ï¼š

```js
function countSubArray(nums) {
  let ans = 1;
  let pre = 1;
  for (let i = 1; i < nums.length; i++) {
    if (nums[i] - nums[i - 1] == 1) {
      pre += 1;
    } else {
      pre = 1;
    }

    ans += pre;
  }
  return ans;
}
```

**å¤æ‚åº¦åˆ†æ**

- æ—¶é—´å¤æ‚åº¦ï¼š$O(N)$ï¼Œå…¶ä¸­ N ä¸ºæ•°ç»„é•¿åº¦ã€‚
- ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$

å¦‚æœæˆ‘å€¼å·®åªè¦å¤§äº 1 å°±è¡Œå‘¢ï¼Ÿå…¶å®æ”¹ä¸‹ç¬¦å·å°±è¡Œäº†ï¼Œè¿™ä¸å°±æ˜¯æ±‚ä¸Šå‡å­åºåˆ—ä¸ªæ•°ä¹ˆï¼Ÿè¿™é‡Œä¸å†ç»§ç»­èµ˜è¿°ï¼Œ å¤§å®¶å¯ä»¥è‡ªå·±è¯•è¯•ã€‚

### æ¯é¢˜ 3

æˆ‘ä»¬ç»§ç»­æ‰©å±•ã€‚

å¦‚æœæˆ‘è®©ä½ æ±‚å‡ºä¸å¤§äº k çš„å­æ•°ç»„çš„ä¸ªæ•°å‘¢ï¼Ÿä¸å¤§äº k æŒ‡çš„æ˜¯å­æ•°ç»„çš„å…¨éƒ¨å…ƒç´ éƒ½ä¸å¤§äº kã€‚ æ¯”å¦‚ [1,3,4] å­æ•°ç»„æœ‰ `[1], [3], [4], [1,3], [3,4] , [1,3,4]`ï¼Œä¸å¤§äº 3 çš„å­æ•°ç»„æœ‰ `[1], [3], [1,3]` ï¼Œé‚£ä¹ˆ [1,3,4] ä¸å¤§äº 3 çš„å­æ•°ç»„ä¸ªæ•°å°±æ˜¯ 3ã€‚ å®ç°å‡½æ•° atMostK(k, nums)ã€‚

å‚è€ƒä»£ç ï¼ˆJSï¼‰:

```js
function countSubArray(k, nums) {
  let ans = 0;
  let pre = 0;
  for (let i = 0; i < nums.length; i++) {
    if (nums[i] <= k) {
      pre += 1;
    } else {
      pre = 0;
    }

    ans += pre;
  }
  return ans;
}
```

**å¤æ‚åº¦åˆ†æ**

- æ—¶é—´å¤æ‚åº¦ï¼š$O(N)$ï¼Œå…¶ä¸­ N ä¸ºæ•°ç»„é•¿åº¦ã€‚
- ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$

### æ¯é¢˜ 4

å¦‚æœæˆ‘è®©ä½ æ±‚å‡ºå­æ•°ç»„æœ€å¤§å€¼åˆšå¥½æ˜¯ k çš„å­æ•°ç»„çš„ä¸ªæ•°å‘¢ï¼Ÿ æ¯”å¦‚ [1,3,4] å­æ•°ç»„æœ‰ `[1], [3], [4], [1,3], [3,4] , [1,3,4]`ï¼Œå­æ•°ç»„æœ€å¤§å€¼åˆšå¥½æ˜¯ 3 çš„å­æ•°ç»„æœ‰ `[3], [1,3]` ï¼Œé‚£ä¹ˆ [1,3,4] å­æ•°ç»„æœ€å¤§å€¼åˆšå¥½æ˜¯ 3 çš„å­æ•°ç»„ä¸ªæ•°å°±æ˜¯ 2ã€‚å®ç°å‡½æ•° exactK(k, nums)ã€‚

å®é™…ä¸Šæ˜¯ exactK å¯ä»¥ç›´æ¥åˆ©ç”¨ atMostKï¼Œå³ atMostK(k) - atMostK(k - 1)ï¼ŒåŸå› è§ä¸‹æ–¹æ¯é¢˜ 5 éƒ¨åˆ†ã€‚

### æ¯é¢˜ 5

å¦‚æœæˆ‘è®©ä½ æ±‚å‡ºå­æ•°ç»„æœ€å¤§å€¼åˆšå¥½æ˜¯ ä»‹äº k1 å’Œ k2 çš„å­æ•°ç»„çš„ä¸ªæ•°å‘¢ï¼Ÿå®ç°å‡½æ•° betweenK(k1, k2, nums)ã€‚

å®é™…ä¸Šæ˜¯ betweenK å¯ä»¥ç›´æ¥åˆ©ç”¨ atMostKï¼Œå³ atMostK(k1, nums) - atMostK(k2 - 1, nums)ï¼Œå…¶ä¸­ k1 > k2ã€‚å‰ææ˜¯å€¼æ˜¯ç¦»æ•£çš„ï¼Œ æ¯”å¦‚ä¸Šé¢æˆ‘å‡ºçš„é¢˜éƒ½æ˜¯æ•´æ•°ã€‚ å› æ­¤æˆ‘å¯ä»¥ç›´æ¥ å‡ 1ï¼Œå› ä¸º **1 æ˜¯ä¸¤ä¸ªæ•´æ•°æœ€å°çš„é—´éš”**ã€‚

![](https://tva1.sinaimg.cn/large/007S8ZIlly1gj8m692laxj30pz0grte9.jpg)

å¦‚ä¸Šï¼Œ`å°äºç­‰äº 10 çš„åŒºåŸŸ`å‡å» `å°äº 5 çš„åŒºåŸŸ`å°±æ˜¯ `å¤§äºç­‰äº 5 ä¸”å°äºç­‰äº 10 çš„åŒºåŸŸ`ã€‚

æ³¨æ„æˆ‘è¯´çš„æ˜¯å°äº 5ï¼Œ ä¸æ˜¯å°äºç­‰äº 5ã€‚ ç”±äºæ•´æ•°æ˜¯ç¦»æ•£çš„ï¼Œæœ€å°é—´éš”æ˜¯ 1ã€‚å› æ­¤å°äº 5 åœ¨è¿™é‡Œå°±ç­‰ä»·äº å°äºç­‰äº 4ã€‚è¿™å°±æ˜¯ betweenK(k1, k2, nums) = atMostK(k1) - atMostK(k2 - 1) çš„åŸå› ã€‚

å› æ­¤ä¸éš¾çœ‹å‡º exactK å…¶å®å°±æ˜¯ betweenK çš„ç‰¹æ®Šå½¢å¼ã€‚ å½“ k1 == k2 çš„æ—¶å€™ï¼Œ betweenK ç­‰ä»·äº exactKã€‚

å› æ­¤ atMostK å°±æ˜¯çµé­‚æ–¹æ³•ï¼Œä¸€å®šè¦æŒæ¡ï¼Œä¸æ˜ç™½å»ºè®®å¤šçœ‹å‡ éã€‚

## å‰ç¼€å’Œçš„ä½¿ç”¨åœºæ™¯

ä¸Šé¢æ˜¯å‰ç¼€å’Œçš„åŸºæœ¬æ¦‚å¿µä»¥åŠç®€å•ä½¿ç”¨ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬æ€»ç»“ä¸€ä¸‹å‰ç¼€å’Œçš„å¸¸è§ä½¿ç”¨åœºæ™¯ã€‚å¤§å®¶ç¢°åˆ°ç±»ä¼¼åœºæ™¯ï¼Œä¸å¦¨æ€è€ƒä¸€ä¸‹æ˜¯å¦å¯é€šè¿‡å‰ç¼€å’Œä»¥ç©ºé—´æ¢æ—¶é—´çš„æ–¹å¼è§£å†³ã€‚

- å·®åˆ†ï¼ˆåé¢æˆ‘ä»¬è¦è®²çš„ 1109. èˆªç­é¢„è®¢ç»Ÿè®¡ å°±ä½¿ç”¨äº†è¿™ä¸ªæŠ€å·§ï¼‰
- å‰ç¼€å’Œä¸äºŒåˆ†ã€‚å¦‚æœ nums æ˜¯ä¸€ä¸ªæ­£æ•´æ•°æ•°ç»„ï¼Œé‚£ä¹ˆå…¶å‰ç¼€å’Œä¸€å®šæ˜¯å•è°ƒé€’å¢çš„ï¼Œæœ‰æ—¶å€™å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ€§è´¨åšäºŒåˆ†ã€‚
- æ±‚åŒºé—´å†…çš„ 1 çš„ä¸ªæ•°ã€‚æ¯”å¦‚ç»™ä½ ä¸€ä¸ªæ•°ç»„ numsï¼Œè®©ä½ æ±‚ä»»æ„åŒºé—´çš„ 1 çš„ä¸ªæ•°ã€‚é‚£ä¹ˆå°±å¯ä»¥å…ˆé¢„å¤„ç†ï¼Œæ¯”å¦‚å°† 1 ä»¥å¤–çš„æ•°å­—é¢„å¤„ç†ä¸º 0ï¼Œç„¶ååšå‰ç¼€å’Œï¼Œæœ€ååšå·®æ±‚åŒºé—´å’Œï¼Œè¿™æ ·åŒºé—´å’Œå°±æ˜¯ 1 çš„ä¸ªæ•°ã€‚ï¼ˆæ¯”å¦‚ [1871. è·³è·ƒæ¸¸æˆ VII](https://github.com/azl397985856/leetcode/blob/master/problems/1871.jump-game-vii.md) å°±åˆ©ç”¨äº†è¿™ä¸ªæŠ€å·§ï¼‰
- åŒºé—´å€¼è®¡æ•°ã€‚ä¸Šé¢æ˜¯å¯¹ nums åŒºé—´æœ¬èº«è¿›è¡Œç»Ÿè®¡ã€‚å¦‚æœæˆ‘æƒ³æ±‚ nums çš„**å€¼**ï¼ˆæ³¨æ„æ˜¯å€¼ï¼Œä¸æ˜¯ç´¢å¼•ï¼‰åœ¨ [lower,upper] ä¹‹é—´çš„æ•°æœ‰å¤šå°‘ï¼Œæ€ä¹ˆæ±‚å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å¼€è¾Ÿä¸€ä¸ªä¸ nums å€¼åŸŸå¤§å°ç­‰å¤§çš„æ•°ç»„ï¼Œå¹¶å¯¹å€¼è¿›è¡Œè®¡æ•°ï¼ˆå³ç»Ÿè®¡ nums çš„å€¼çš„å‡ºç°é¢‘ç‡ï¼‰ï¼Œæ¥ä¸‹æ¥å°±å’Œæ™®é€šå‰ç¼€å’Œä¸€æ ·äº†ã€‚ï¼ˆæ¯”å¦‚ [1862. å‘ä¸‹å–æ•´æ•°å¯¹å’Œ](https://leetcode-cn.com/problems/sum-of-floored-pairs/) å°±åˆ©ç”¨äº†è¿™ä¸ªæŠ€å·§ï¼‰
- åŒºé—´å€¼è®¡æ•°æ‰©å±•ã€‚ä¸Šé¢çš„åŒºé—´å€¼è®¡æ•°æ²¡æœ‰å¯¹ç´¢å¼•è¿›è¡Œé™åˆ¶ï¼Œé‚£å¦‚æœæˆ‘åŠ äº†ç´¢å¼•çš„é™åˆ¶å‘¢ï¼Ÿæ¯”å¦‚æˆ‘æƒ³æ±‚ç´¢å¼•åœ¨ [l,r] å¹¶ä¸”å€¼åœ¨ [lower,upper]çš„å€¼çš„ä¸ªæ•°å¦‚ä½•æ±‚ï¼Ÿæˆ‘ä»¬å¯ä»¥å…ˆåšä¸€ä¸ªäºŒç»´å‰ç¼€å’Œ pre[i][j] è¡¨ç¤º å‰ i é¡¹ j çš„å‡ºç°æ¬¡æ•°ï¼ˆæ˜¾ç„¶ pre çš„è§„æ¨¡ä¸ºæ•°ç»„é•¿åº¦ä¹˜ä»¥æ•°ç»„å€¼åŸŸå¤§å°ï¼‰ï¼Œæ¥ä¸‹æ¥ä¾æ¬¡æšä¸¾ [lower,upper]çš„æ‰€æœ‰æ•° curï¼Œå¹¶åˆ©ç”¨ pre[r][cur] - pre[l-1][cur]ï¼Œå°†ç»“æœè¿›è¡Œç´¯åŠ å³å¯ã€‚ï¼ˆæ¯”å¦‚[1906. æŸ¥è¯¢å·®ç»å¯¹å€¼çš„æœ€å°å€¼](https://leetcode-cn.com/problems/minimum-absolute-difference-queries/) å°±ä½¿ç”¨äº†è¿™ä¸ªæŠ€å·§ï¼‰

æœ‰äº†ä¸Šé¢çš„é“ºå«ï¼Œ æˆ‘ä»¬æ¥çœ‹ä¸‹ç¬¬ä¸€é“é¢˜ã€‚

## 467. ç¯ç»•å­—ç¬¦ä¸²ä¸­å”¯ä¸€çš„å­å­—ç¬¦ä¸²ï¼ˆä¸­ç­‰ï¼‰

### é¢˜ç›®æè¿°

```
æŠŠå­—ç¬¦ä¸² s çœ‹ä½œæ˜¯â€œabcdefghijklmnopqrstuvwxyzâ€çš„æ— é™ç¯ç»•å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥Â s çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š"...zabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcd....".Â 

ç°åœ¨æˆ‘ä»¬æœ‰äº†å¦ä¸€ä¸ªå­—ç¬¦ä¸² p ã€‚ä½ éœ€è¦çš„æ˜¯æ‰¾å‡º s ä¸­æœ‰å¤šå°‘ä¸ªå”¯ä¸€çš„ p çš„éç©ºå­ä¸²ï¼Œå°¤å…¶æ˜¯å½“ä½ çš„è¾“å…¥æ˜¯å­—ç¬¦ä¸² p ï¼Œä½ éœ€è¦è¾“å‡ºå­—ç¬¦ä¸²Â s ä¸­ p çš„ä¸åŒçš„éç©ºå­ä¸²çš„æ•°ç›®ã€‚Â 

æ³¨æ„: pÂ ä»…ç”±å°å†™çš„è‹±æ–‡å­—æ¯ç»„æˆï¼Œp çš„å¤§å°å¯èƒ½è¶…è¿‡ 10000ã€‚

Â 

ç¤ºä¾‹Â 1:

è¾“å…¥: "a"
è¾“å‡º: 1
è§£é‡Š: å­—ç¬¦ä¸² S ä¸­åªæœ‰ä¸€ä¸ª"a"å­å­—ç¬¦ã€‚
Â 

ç¤ºä¾‹ 2:

è¾“å…¥: "cac"
è¾“å‡º: 2
è§£é‡Š: å­—ç¬¦ä¸² S ä¸­çš„å­—ç¬¦ä¸²â€œcacâ€åªæœ‰ä¸¤ä¸ªå­ä¸²â€œaâ€ã€â€œcâ€ã€‚.
Â 

ç¤ºä¾‹ 3:

è¾“å…¥: "zab"
è¾“å‡º: 6
è§£é‡Š: åœ¨å­—ç¬¦ä¸² S ä¸­æœ‰å…­ä¸ªå­ä¸²â€œzâ€ã€â€œaâ€ã€â€œbâ€ã€â€œzaâ€ã€â€œabâ€ã€â€œzabâ€ã€‚.
Â 

```

### å‰ç½®çŸ¥è¯†

- æ»‘åŠ¨çª—å£

### æ€è·¯

é¢˜ç›®æ˜¯è®©æˆ‘ä»¬æ‰¾ p åœ¨ s ä¸­å‡ºç°çš„éç©ºå­ä¸²æ•°ç›®ï¼Œè€Œ s æ˜¯å›ºå®šçš„ä¸€ä¸ªæ— é™å¾ªç¯å­—ç¬¦ä¸²ã€‚ç”±äº p çš„æ•°æ®èŒƒå›´æ˜¯ 10^5 ï¼Œå› æ­¤æš´åŠ›æ‰¾å‡ºæ‰€æœ‰å­ä¸²å°±éœ€è¦ 10^10 æ¬¡æ“ä½œäº†ï¼Œåº”è¯¥ä¼šè¶…æ—¶ã€‚è€Œä¸”é¢˜ç›®å¾ˆå¤šä¿¡æ¯éƒ½æ²¡ç”¨åˆ°ï¼Œè‚¯å®šä¸å¯¹ã€‚

ä»”ç»†çœ‹ä¸‹é¢˜ç›®å‘ç°ï¼Œè¿™ä¸å°±æ˜¯æ¯é¢˜ 2 çš„å˜ç§ä¹ˆï¼Ÿè¯ä¸å¤šè¯´ï¼Œ ç›´æ¥ä¸Šä»£ç ï¼Œçœ‹çœ‹æœ‰å¤šåƒã€‚

> ä¸ºäº†å‡å°‘åˆ¤æ–­ï¼Œ æˆ‘è¿™é‡Œç”¨äº†ä¸€ä¸ªé»‘ç§‘æŠ€ï¼Œ p å‰é¢åŠ äº†ä¸ª `^`ã€‚

```py
class Solution:
    def findSubstringInWraproundString(self, p: str) -> int:
        p = '^' + p
        w = 1
        ans = 0
        for i in range(1,len(p)):
            if ord(p[i])-ord(p[i-1]) == 1 or ord(p[i])-ord(p[i-1]) == -25:
                w += 1
            else:
                w = 1
            ans += w
        return ans
```

å¦‚ä¸Šä»£ç æ˜¯æœ‰é—®é¢˜ã€‚ æ¯”å¦‚ `cac`ä¼šè¢«è®¡ç®—ä¸º 3ï¼Œå®é™…ä¸Šåº”è¯¥æ˜¯ 2ã€‚æ ¹æœ¬åŸå› åœ¨äº c è¢«é”™è¯¯åœ°è®¡ç®—äº†ä¸¤æ¬¡ã€‚å› æ­¤ä¸€ä¸ªç®€å•çš„æ€è·¯å°±æ˜¯ç”¨ set è®°å½•ä¸€ä¸‹è®¿é—®è¿‡çš„å­å­—ç¬¦ä¸²å³å¯ã€‚æ¯”å¦‚ï¼š

```py
{
    c,
    abc,
    ab,
    abcd
}

```

è€Œç”±äº set ä¸­çš„å…ƒç´ ä¸€å®šæ˜¯è¿ç»­çš„ï¼Œå› æ­¤ä¸Šé¢çš„æ•°æ®ä¹Ÿå¯ä»¥ç”¨ hashmap å­˜ï¼š

```
{
    c: 3
    d: 4
    b: 1
}

```

å«ä¹‰æ˜¯ï¼š

- ä»¥ b ç»“å°¾çš„å­ä¸²æœ€å¤§é•¿åº¦ä¸º 1ï¼Œä¹Ÿå°±æ˜¯ bã€‚
- ä»¥ c ç»“å°¾çš„å­ä¸²æœ€å¤§é•¿åº¦ä¸º 3ï¼Œä¹Ÿå°±æ˜¯ abcã€‚
- ä»¥ d ç»“å°¾çš„å­ä¸²æœ€å¤§é•¿åº¦ä¸º 4ï¼Œä¹Ÿå°±æ˜¯ abcdã€‚

è‡³äº c ï¼Œæ˜¯æ²¡æœ‰å¿…è¦å­˜çš„ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ¯é¢˜ 2 çš„æ–¹å¼ç®—å‡ºæ¥ã€‚

å…·ä½“ç®—æ³•ï¼š

- å®šä¹‰ä¸€ä¸ª len_mapperã€‚key æ˜¯ å­—æ¯ï¼Œ value æ˜¯ é•¿åº¦ã€‚ å«ä¹‰æ˜¯ä»¥ key ç»“å°¾çš„æœ€é•¿è¿ç»­å­ä¸²çš„é•¿åº¦ã€‚

> å…³é”®å­—æ˜¯ï¼šæœ€é•¿

- ç”¨ä¸€ä¸ªå˜é‡ w è®°å½•è¿ç»­å­ä¸²çš„é•¿åº¦ï¼Œéå†è¿‡ç¨‹æ ¹æ® w çš„å€¼æ›´æ–° len_mapper
- è¿”å› len_mapper ä¸­æ‰€æœ‰ value çš„å’Œã€‚

æ¯”å¦‚: abcï¼Œæ­¤æ—¶çš„ len_mapper ä¸º:

```py
{
    c: 3
    b: 2
    a: 1
}
```

å†æ¯”å¦‚ï¼šabcabï¼Œæ­¤æ—¶çš„ len_mapper ä¾æ—§ã€‚

å†æ¯”å¦‚: abcazabcï¼Œæ­¤æ—¶çš„ len_mapperï¼š

```py
{
    c: 4
    b: 3
    a: 2
    z: 1
}
```

è¿™å°±å¾—åˆ°äº†å»é‡çš„ç›®çš„ã€‚è¿™ç§ç®—æ³•æ˜¯ä¸é‡ä¸æ¼çš„ï¼Œå› ä¸ºæœ€é•¿çš„è¿ç»­å­ä¸²ä¸€å®šæ˜¯åŒ…å«äº†æ¯”å®ƒçŸ­çš„è¿ç»­å­ä¸²ï¼Œè¿™ä¸ªæ€æƒ³å’Œ [1297. å­ä¸²çš„æœ€å¤§å‡ºç°æ¬¡æ•°](https://github.com/azl397985856/leetcode/issues/266 "1297. å­ä¸²çš„æœ€å¤§å‡ºç°æ¬¡æ•°") å‰ªæçš„æ–¹æ³•æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚

### ä»£ç ï¼ˆPythonï¼‰

```py
class Solution:
    def findSubstringInWraproundString(self, p: str) -> int:
        p = '^' + p
        len_mapper = collections.defaultdict(lambda: 0)
        w = 1
        for i in range(1,len(p)):
            if ord(p[i])-ord(p[i-1]) == 1 or ord(p[i])-ord(p[i-1]) == -25:
                w += 1
            else:
                w = 1
            len_mapper[p[i]] = max(len_mapper[p[i]], w)
        return sum(len_mapper.values())
```

**å¤æ‚åº¦åˆ†æ**

- æ—¶é—´å¤æ‚åº¦ï¼š$O(N)$ï¼Œå…¶ä¸­ $N$ ä¸ºå­—ç¬¦ä¸² p çš„é•¿åº¦ã€‚
- ç©ºé—´å¤æ‚åº¦ï¼šç”±äºæœ€å¤šå­˜å‚¨ 26 ä¸ªå­—æ¯ï¼Œ å› æ­¤ç©ºé—´å®é™…ä¸Šæ˜¯å¸¸æ•°ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º $O(1)$ã€‚

## 795. åŒºé—´å­æ•°ç»„ä¸ªæ•°ï¼ˆä¸­ç­‰ï¼‰

### é¢˜ç›®æè¿°

```

ç»™å®šä¸€ä¸ªå…ƒç´ éƒ½æ˜¯æ­£æ•´æ•°çš„æ•°ç»„ AÂ ï¼Œæ­£æ•´æ•° LÂ  ä»¥åŠ Â RÂ (L <= R)ã€‚

æ±‚è¿ç»­ã€éç©ºä¸”å…¶ä¸­æœ€å¤§å…ƒç´ æ»¡è¶³å¤§äºç­‰äº LÂ  å°äºç­‰äº R çš„å­æ•°ç»„ä¸ªæ•°ã€‚

ä¾‹å¦‚ :
è¾“å…¥:
A = [2, 1, 4, 3]
L = 2
R = 3
è¾“å‡º: 3
è§£é‡Š: æ»¡è¶³æ¡ä»¶çš„å­æ•°ç»„: [2], [2, 1], [3].
æ³¨æ„:

L, RÂ  å’Œ Â A[i] éƒ½æ˜¯æ•´æ•°ï¼ŒèŒƒå›´åœ¨ Â [0, 10^9]ã€‚
æ•°ç»„ Â AÂ  çš„é•¿åº¦èŒƒå›´åœ¨[1, 50000]ã€‚

```

### å‰ç½®çŸ¥è¯†

- æ»‘åŠ¨çª—å£

### æ€è·¯

ç”±æ¯é¢˜ 5ï¼Œæˆ‘ä»¬çŸ¥é“ **betweenK å¯ä»¥ç›´æ¥åˆ©ç”¨ atMostKï¼Œå³ atMostK(k1) - atMostK(k2 - 1)ï¼Œå…¶ä¸­ k1 > k2**ã€‚

ç”±æ¯é¢˜ 2ï¼Œæˆ‘ä»¬çŸ¥é“å¦‚ä½•æ±‚æ»¡è¶³ä¸€å®šæ¡ä»¶ï¼ˆè¿™é‡Œæ˜¯å…ƒç´ éƒ½å°äºç­‰äº Rï¼‰å­æ•°ç»„çš„ä¸ªæ•°ã€‚

è¿™ä¸¤ä¸ªç»“åˆä¸€ä¸‹ï¼Œ å°±å¯ä»¥è§£å†³ã€‚

### ä»£ç ï¼ˆPythonï¼‰

> ä»£ç æ˜¯ä¸æ˜¯å¾ˆåƒ

```py
class Solution:
    def numSubarrayBoundedMax(self, A: List[int], L: int, R: int) -> int:
        def notGreater(R):
            ans = cnt = 0
            for a in A:
                if a <= R: cnt += 1
                else: cnt = 0
                ans += cnt
            return  ans

        return notGreater(R) - notGreater(L - 1)
```

**_å¤æ‚åº¦åˆ†æ_**

- æ—¶é—´å¤æ‚åº¦ï¼š$O(N)$ï¼Œå…¶ä¸­ $N$ ä¸ºæ•°ç»„é•¿åº¦ã€‚
- ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$ã€‚

## 904. æ°´æœæˆç¯®ï¼ˆä¸­ç­‰ï¼‰

### é¢˜ç›®æè¿°

```
åœ¨ä¸€æ’æ ‘ä¸­ï¼Œç¬¬ i æ£µæ ‘äº§ç”ŸÂ tree[i] å‹çš„æ°´æœã€‚
ä½ å¯ä»¥ä»ä½ é€‰æ‹©çš„ä»»ä½•æ ‘å¼€å§‹ï¼Œç„¶åé‡å¤æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

æŠŠè¿™æ£µæ ‘ä¸Šçš„æ°´æœæ”¾è¿›ä½ çš„ç¯®å­é‡Œã€‚å¦‚æœä½ åšä¸åˆ°ï¼Œå°±åœä¸‹æ¥ã€‚
ç§»åŠ¨åˆ°å½“å‰æ ‘å³ä¾§çš„ä¸‹ä¸€æ£µæ ‘ã€‚å¦‚æœå³è¾¹æ²¡æœ‰æ ‘ï¼Œå°±åœä¸‹æ¥ã€‚
è¯·æ³¨æ„ï¼Œåœ¨é€‰æ‹©ä¸€é¢—æ ‘åï¼Œä½ æ²¡æœ‰ä»»ä½•é€‰æ‹©ï¼šä½ å¿…é¡»æ‰§è¡Œæ­¥éª¤ 1ï¼Œç„¶åæ‰§è¡Œæ­¥éª¤ 2ï¼Œç„¶åè¿”å›æ­¥éª¤ 1ï¼Œç„¶åæ‰§è¡Œæ­¥éª¤ 2ï¼Œä¾æ­¤ç±»æ¨ï¼Œç›´è‡³åœæ­¢ã€‚

ä½ æœ‰ä¸¤ä¸ªç¯®å­ï¼Œæ¯ä¸ªç¯®å­å¯ä»¥æºå¸¦ä»»ä½•æ•°é‡çš„æ°´æœï¼Œä½†ä½ å¸Œæœ›æ¯ä¸ªç¯®å­åªæºå¸¦ä¸€ç§ç±»å‹çš„æ°´æœã€‚

ç”¨è¿™ä¸ªç¨‹åºä½ èƒ½æ”¶é›†çš„æ°´æœæ ‘çš„æœ€å¤§æ€»é‡æ˜¯å¤šå°‘ï¼Ÿ

Â 

ç¤ºä¾‹ 1ï¼š

è¾“å…¥ï¼š[1,2,1]
è¾“å‡ºï¼š3
è§£é‡Šï¼šæˆ‘ä»¬å¯ä»¥æ”¶é›† [1,2,1]ã€‚
ç¤ºä¾‹ 2ï¼š

è¾“å…¥ï¼š[0,1,2,2]
è¾“å‡ºï¼š3
è§£é‡Šï¼šæˆ‘ä»¬å¯ä»¥æ”¶é›† [1,2,2]
å¦‚æœæˆ‘ä»¬ä»ç¬¬ä¸€æ£µæ ‘å¼€å§‹ï¼Œæˆ‘ä»¬å°†åªèƒ½æ”¶é›†åˆ° [0, 1]ã€‚
ç¤ºä¾‹ 3ï¼š

è¾“å…¥ï¼š[1,2,3,2,2]
è¾“å‡ºï¼š4
è§£é‡Šï¼šæˆ‘ä»¬å¯ä»¥æ”¶é›† [2,3,2,2]
å¦‚æœæˆ‘ä»¬ä»ç¬¬ä¸€æ£µæ ‘å¼€å§‹ï¼Œæˆ‘ä»¬å°†åªèƒ½æ”¶é›†åˆ° [1, 2]ã€‚
ç¤ºä¾‹ 4ï¼š

è¾“å…¥ï¼š[3,3,3,1,2,1,1,2,3,3,4]
è¾“å‡ºï¼š5
è§£é‡Šï¼šæˆ‘ä»¬å¯ä»¥æ”¶é›† [1,2,1,1,2]
å¦‚æœæˆ‘ä»¬ä»ç¬¬ä¸€æ£µæ ‘æˆ–ç¬¬å…«æ£µæ ‘å¼€å§‹ï¼Œæˆ‘ä»¬å°†åªèƒ½æ”¶é›†åˆ° 4 æ£µæ°´æœæ ‘ã€‚
Â 

æç¤ºï¼š

1 <= tree.length <= 40000
0 <= tree[i] < tree.length

```

### å‰ç½®çŸ¥è¯†

- æ»‘åŠ¨çª—å£

### æ€è·¯

é¢˜ç›®èŠ±é‡Œèƒ¡å“¨çš„ã€‚æˆ‘ä»¬æ¥æŠ½è±¡ä¸€ä¸‹ï¼Œå°±æ˜¯ç»™ä½ ä¸€ä¸ªæ•°ç»„ï¼Œ è®©ä½ **é€‰å®šä¸€ä¸ªå­æ•°ç»„ï¼Œ è¿™ä¸ªå­æ•°ç»„æœ€å¤šåªæœ‰ä¸¤ç§æ•°å­—**ï¼Œè¿™ä¸ªé€‰å®šçš„å­æ•°ç»„æœ€å¤§å¯ä»¥æ˜¯å¤šå°‘ã€‚

è¿™ä¸å°±å’Œæ¯é¢˜ 3 ä¸€æ ·ä¹ˆï¼Ÿåªä¸è¿‡ k å˜æˆäº†å›ºå®šå€¼ 2ã€‚å¦å¤–ç”±äºé¢˜ç›®è¦æ±‚æ•´ä¸ªçª—å£æœ€å¤šä¸¤ç§æ•°å­—ï¼Œæˆ‘ä»¬ç”¨å“ˆå¸Œè¡¨å­˜ä¸€ä¸‹ä¸å°±å¥½äº†å—ï¼Ÿ

> set æ˜¯ä¸è¡Œäº†çš„ã€‚ å› æ­¤æˆ‘ä»¬ä¸ä½†éœ€è¦çŸ¥é“å‡ ä¸ªæ•°å­—åœ¨çª—å£ï¼Œ æˆ‘ä»¬è¿˜è¦çŸ¥é“æ¯ä¸ªæ•°å­—å‡ºç°çš„æ¬¡æ•°ï¼Œè¿™æ ·æ‰å¯ä»¥ä½¿ç”¨æ»‘åŠ¨çª—å£ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦ã€‚

### ä»£ç ï¼ˆPythonï¼‰

```py
class Solution:
    def totalFruit(self, tree: List[int]) -> int:
        def atMostK(k, nums):
            i = ans = 0
            win = defaultdict(lambda: 0)
            for j in range(len(nums)):
                if win[nums[j]] == 0: k -= 1
                win[nums[j]] += 1
                while k < 0:
                    win[nums[i]] -= 1
                    if win[nums[i]] == 0: k += 1
                    i += 1
                ans = max(ans, j - i + 1)
            return ans

        return atMostK(2, tree)
```

**å¤æ‚åº¦åˆ†æ**

- æ—¶é—´å¤æ‚åº¦ï¼š$O(N)$ï¼Œå…¶ä¸­ $N$ ä¸ºæ•°ç»„é•¿åº¦ã€‚
- ç©ºé—´å¤æ‚åº¦ï¼š$O(k)$ã€‚

## 992. K ä¸ªä¸åŒæ•´æ•°çš„å­æ•°ç»„ï¼ˆå›°éš¾ï¼‰

### é¢˜ç›®æè¿°

```
ç»™å®šä¸€ä¸ªæ­£æ•´æ•°æ•°ç»„ Aï¼Œå¦‚æœ AÂ çš„æŸä¸ªå­æ•°ç»„ä¸­ä¸åŒæ•´æ•°çš„ä¸ªæ•°æ°å¥½ä¸º Kï¼Œåˆ™ç§° A çš„è¿™ä¸ªè¿ç»­ã€ä¸ä¸€å®šç‹¬ç«‹çš„å­æ•°ç»„ä¸ºå¥½å­æ•°ç»„ã€‚

ï¼ˆä¾‹å¦‚ï¼Œ[1,2,3,1,2] ä¸­æœ‰Â 3Â ä¸ªä¸åŒçš„æ•´æ•°ï¼š1ï¼Œ2ï¼Œä»¥åŠÂ 3ã€‚ï¼‰

è¿”å›Â AÂ ä¸­å¥½å­æ•°ç»„çš„æ•°ç›®ã€‚

Â 

ç¤ºä¾‹ 1ï¼š

è¾“å…¥ï¼šA = [1,2,1,2,3], K = 2
è¾“å‡ºï¼š7
è§£é‡Šï¼šæ°å¥½ç”± 2 ä¸ªä¸åŒæ•´æ•°ç»„æˆçš„å­æ•°ç»„ï¼š[1,2], [2,1], [1,2], [2,3], [1,2,1], [2,1,2], [1,2,1,2].
ç¤ºä¾‹ 2ï¼š

è¾“å…¥ï¼šA = [1,2,1,3,4], K = 3
è¾“å‡ºï¼š3
è§£é‡Šï¼šæ°å¥½ç”± 3 ä¸ªä¸åŒæ•´æ•°ç»„æˆçš„å­æ•°ç»„ï¼š[1,2,1,3], [2,1,3], [1,3,4].
Â 

æç¤ºï¼š

1 <= A.length <= 20000
1 <= A[i] <= A.length
1 <= K <= A.length



```

### å‰ç½®çŸ¥è¯†

- æ»‘åŠ¨çª—å£

### æ€è·¯

ç”±æ¯é¢˜ 5ï¼ŒçŸ¥ï¼šexactK = atMostK(k) - atMostK(k - 1)ï¼Œ å› æ­¤ç­”æ¡ˆä¾¿å‘¼ä¹‹æ¬²å‡ºäº†ã€‚å…¶ä»–éƒ¨åˆ†å’Œä¸Šé¢çš„é¢˜ç›® `904. æ°´æœæˆç¯®` ä¸€æ ·ã€‚

> å®é™…ä¸Šå’Œæ‰€æœ‰çš„æ»‘åŠ¨çª—å£é¢˜ç›®éƒ½å·®ä¸å¤šã€‚

### ä»£ç ï¼ˆPythonï¼‰

```py
class Solution:
    def subarraysWithKDistinct(self, A, K):
        return self.atMostK(A, K) - self.atMostK(A, K - 1)

    def atMostK(self, A, K):
        counter = collections.Counter()
        res = i = 0
        for j in range(len(A)):
            if counter[A[j]] == 0:
                K -= 1
            counter[A[j]] += 1
            while K < 0:
                counter[A[i]] -= 1
                if counter[A[i]] == 0:
                    K += 1
                i += 1
            res += j - i + 1
        return res
```

**å¤æ‚åº¦åˆ†æ**

- æ—¶é—´å¤æ‚åº¦ï¼š$O(N)$ï¼Œä¸­ $N$ ä¸ºæ•°ç»„é•¿åº¦ã€‚
- ç©ºé—´å¤æ‚åº¦ï¼š$O(k)$ã€‚

## 1109. èˆªç­é¢„è®¢ç»Ÿè®¡ï¼ˆä¸­ç­‰ï¼‰

### é¢˜ç›®æè¿°

```

è¿™é‡Œæœ‰ Â nÂ  ä¸ªèˆªç­ï¼Œå®ƒä»¬åˆ†åˆ«ä» 1 åˆ° n è¿›è¡Œç¼–å·ã€‚

æˆ‘ä»¬è¿™å„¿æœ‰ä¸€ä»½èˆªç­é¢„è®¢è¡¨ï¼Œè¡¨ä¸­ç¬¬ Â iÂ  æ¡é¢„è®¢è®°å½• Â bookings[i] = [i, j, k]Â  æ„å‘³ç€æˆ‘ä»¬åœ¨ä» Â iÂ  åˆ° Â jÂ  çš„æ¯ä¸ªèˆªç­ä¸Šé¢„è®¢äº† k ä¸ªåº§ä½ã€‚

è¯·ä½ è¿”å›ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•°ç»„ Â answerï¼ŒæŒ‰èˆªç­ç¼–å·é¡ºåºè¿”å›æ¯ä¸ªèˆªç­ä¸Šé¢„è®¢çš„åº§ä½æ•°ã€‚



ç¤ºä¾‹ï¼š

è¾“å…¥ï¼šbookings = [[1,2,10],[2,3,20],[2,5,25]], n = 5
è¾“å‡ºï¼š[10,55,45,25,25]



æç¤ºï¼š

1 <= bookings.length <= 20000
1 <= bookings[i][0] <= bookings[i][1] <= n <= 20000
1 <= bookings[i][2] <= 10000
```

### å‰ç½®çŸ¥è¯†

- å‰ç¼€å’Œ

### æ€è·¯

è¿™é“é¢˜çš„é¢˜ç›®æè¿°ä¸æ˜¯å¾ˆæ¸…æ¥šã€‚æˆ‘ç®€å•åˆ†æä¸€ä¸‹é¢˜ç›®ï¼š

[i, j, k] å…¶å®ä»£è¡¨çš„æ˜¯ ç¬¬ i ç«™ä¸Šæ¥äº† k ä¸ªäººï¼Œ ä¸€ç›´åˆ° ç¬¬ j ç«™éƒ½åœ¨é£æœºä¸Šï¼Œåˆ°ç¬¬ j + 1 å°±ä¸åœ¨é£æœºä¸Šäº†ã€‚æ‰€ä»¥ç¬¬ i ç«™åˆ°ç¬¬ j ç«™çš„**æ¯ä¸€ç«™**éƒ½ä¼šå› æ­¤å¤š k ä¸ªäººã€‚

ç†è§£äº†é¢˜ç›®åªä¼šä¸éš¾å†™å‡ºä¸‹é¢çš„ä»£ç ã€‚

```py
class Solution:
    def corpFlightBookings(self, bookings: List[List[int]], n: int) -> List[int]:
        counter = [0] * n

        for i, j, k in bookings:
            while i <= j:
                counter[i - 1] += k
                i += 1
        return counter
```

å¦‚ä¸Šçš„ä»£ç å¤æ‚åº¦å¤ªé«˜ï¼Œæ— æ³•é€šè¿‡å…¨éƒ¨çš„æµ‹è¯•ç”¨ä¾‹ã€‚

**æ³¨æ„åˆ°é‡Œå±‚çš„ while å¾ªç¯æ˜¯è¿ç»­çš„æ•°ç»„å…¨éƒ¨åŠ ä¸Šä¸€ä¸ªæ•°å­—ï¼Œä¸éš¾æƒ³åˆ°å¯ä»¥åˆ©ç”¨æ¯é¢˜ 0 çš„å‰ç¼€å’Œæ€è·¯ä¼˜åŒ–ã€‚**

![](https://tva1.sinaimg.cn/large/007S8ZIlly1gj8k7w0bqyj30qh07540b.jpg)

ä¸€ç§æ€è·¯å°±æ˜¯åœ¨ i çš„ä½ç½® + kï¼Œ ç„¶ååˆ©ç”¨å‰ç¼€å’Œçš„æŠ€å·§ç»™ i åˆ° n çš„å…ƒç´ éƒ½åŠ ä¸Š kã€‚ä½†æ˜¯é¢˜ç›®éœ€è¦åŠ çš„æ˜¯ä¸€ä¸ªåŒºé—´ï¼Œ j + 1 åŠå…¶ä¹‹åçš„å…ƒç´ ä¼šè¢«å¤šåŠ ä¸€ä¸ª kã€‚ä¸€ä¸ªç®€å•çš„æŠ€å·§å°±æ˜¯ç»™ j + 1 çš„å…ƒç´ å‡å» kï¼Œè¿™æ ·æ­£è´Ÿå°±å¯ä»¥æŠµæ¶ˆã€‚

![](https://tva1.sinaimg.cn/large/007S8ZIlly1gj8k997nmbj30q9074dhm.jpg)

> 1094. æ‹¼è½¦ æ˜¯è¿™é“é¢˜çš„æ¢çš®é¢˜ï¼Œ æ€è·¯ä¸€æ¨¡ä¸€æ ·ã€‚

### ä»£ç ï¼ˆPythonï¼‰

```py
class Solution:
    def corpFlightBookings(self, bookings: List[List[int]], n: int) -> List[int]:
        counter = [0] * (n + 1)

        for i, j, k in bookings:
            counter[i - 1] += k
            if j < n: counter[j] -= k
        for i in range(n + 1):
            counter[i] += counter[i - 1]
        return counter[:-1]
```

**å¤æ‚åº¦åˆ†æ**

- æ—¶é—´å¤æ‚åº¦ï¼š$O(N)$ï¼Œä¸­ $N$ ä¸ºæ•°ç»„é•¿åº¦ã€‚
- ç©ºé—´å¤æ‚åº¦ï¼š$O(N)$ã€‚

## æ€»ç»“

è¿™å‡ é“é¢˜éƒ½æ˜¯æ»‘åŠ¨çª—å£å’Œå‰ç¼€å’Œçš„æ€è·¯ã€‚åŠ›æ‰£ç±»ä¼¼çš„é¢˜ç›®è¿˜çœŸä¸å°‘ï¼Œå¤§å®¶åªæœ‰å¤šç•™å¿ƒï¼Œå°±ä¼šå‘ç°è¿™ä¸ªå¥—è·¯ã€‚

å‰ç¼€å’Œçš„æŠ€å·§ä»¥åŠæ»‘åŠ¨çª—å£çš„æŠ€å·§éƒ½æ¯”è¾ƒå›ºå®šï¼Œä¸”æœ‰æ¨¡æ¿å¯å¥—ã€‚ éš¾ç‚¹å°±åœ¨äºæˆ‘æ€ä¹ˆæ‰èƒ½æƒ³åˆ°å¯ä»¥ç”¨è¿™ä¸ªæŠ€å·§å‘¢ï¼Ÿ

æˆ‘è¿™é‡Œæ€»ç»“äº†ä¸¤ç‚¹ï¼š

1. æ‰¾å…³é”®å­—ã€‚æ¯”å¦‚é¢˜ç›®ä¸­æœ‰è¿ç»­ï¼Œå°±åº”è¯¥æ¡ä»¶åå°„æƒ³åˆ°æ»‘åŠ¨çª—å£å’Œå‰ç¼€å’Œã€‚æ¯”å¦‚é¢˜ç›®æ±‚æœ€å¤§æœ€å°å°±æƒ³åˆ°åŠ¨æ€è§„åˆ’å’Œè´ªå¿ƒç­‰ç­‰ã€‚æƒ³åˆ°ä¹‹åï¼Œå°±å¯ä»¥å’Œé¢˜ç›®ä¿¡æ¯å¯¹æ¯”å¿«é€Ÿæ’é™¤é”™è¯¯çš„ç®—æ³•ï¼Œæ‰¾åˆ°å¯è¡Œè§£ã€‚è¿™ä¸ªæ€è€ƒçš„æ—¶é—´ä¼šéšç€ä½ çš„é¢˜æ„Ÿå¢åŠ è€Œé™ä½ã€‚
2. å…ˆå†™å‡ºæš´åŠ›è§£ï¼Œç„¶åæ‰¾æš´åŠ›è§£çš„ç“¶é¢ˆï¼Œ æ ¹æ®ç“¶é¢ˆå°±å¾ˆå®¹æ˜“çŸ¥é“åº”è¯¥ç”¨ä»€ä¹ˆæ•°æ®ç»“æ„å’Œç®—æ³•å»ä¼˜åŒ–ã€‚

æœ€åæ¨èå‡ é“ç±»ä¼¼çš„é¢˜ç›®ï¼Œ ä¾›å¤§å®¶ç»ƒä¹ ï¼Œä¸€å®šè¦è‡ªå·±å†™å‡ºæ¥æ‰è¡Œå“¦ã€‚

- [303. åŒºåŸŸå’Œæ£€ç´¢ - æ•°ç»„ä¸å¯å˜](https://leetcode-cn.com/problems/range-sum-query-immutable/description/ "303. åŒºåŸŸå’Œæ£€ç´¢ - æ•°ç»„ä¸å¯å˜")
- [1171. ä»é“¾è¡¨ä¸­åˆ å»æ€»å’Œå€¼ä¸ºé›¶çš„è¿ç»­èŠ‚ç‚¹](https://leetcode-cn.com/problems/remove-zero-sum-consecutive-nodes-from-linked-list/)
- [1186.åˆ é™¤ä¸€æ¬¡å¾—åˆ°å­æ•°ç»„æœ€å¤§å’Œ](https://lucifer.ren/blog/2019/12/11/leetcode-1186/ "1186.åˆ é™¤ä¸€æ¬¡å¾—åˆ°å­æ•°ç»„æœ€å¤§å’Œ")
- [1310. å­æ•°ç»„å¼‚æˆ–æŸ¥è¯¢](https://lucifer.ren/blog/2020/01/09/1310.xor-queries-of-a-subarray/ "1310. å­æ•°ç»„å¼‚æˆ–æŸ¥è¯¢")
- [1371. æ¯ä¸ªå…ƒéŸ³åŒ…å«å¶æ•°æ¬¡çš„æœ€é•¿å­å­—ç¬¦ä¸²](https://github.com/azl397985856/leetcode/blob/master/problems/1371.find-the-longest-substring-containing-vowels-in-even-counts.md "1371. æ¯ä¸ªå…ƒéŸ³åŒ…å«å¶æ•°æ¬¡çš„æœ€é•¿å­å­—ç¬¦ä¸²")
- [1402. åšèœé¡ºåº](https://leetcode-cn.com/problems/reducing-dishes/)

å¤§å®¶å¯¹æ­¤æœ‰ä½•çœ‹æ³•ï¼Œæ¬¢è¿ç»™æˆ‘ç•™è¨€ï¼Œæˆ‘æœ‰æ—¶é—´éƒ½ä¼šä¸€ä¸€æŸ¥çœ‹å›ç­”ã€‚

æ›´å¤šç®—æ³•å¥—è·¯å¯ä»¥è®¿é—®æˆ‘çš„ LeetCode é¢˜è§£ä»“åº“ï¼šhttps://github.com/azl397985856/leetcode ã€‚ ç›®å‰å·²ç» 36K star å•¦ã€‚

å¤§å®¶ä¹Ÿå¯ä»¥å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€ŠåŠ›æ‰£åŠ åŠ ã€‹å¸¦ä½ å•ƒä¸‹ç®—æ³•è¿™å—ç¡¬éª¨å¤´ã€‚

![](https://tva1.sinaimg.cn/large/007S8ZIlly1gfcuzagjalj30p00dwabs.jpg)
